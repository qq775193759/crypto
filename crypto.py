def int_to_list(d):
    list = []
    while(d>0):
        list.append(d%2)
        d = d/2
    list.reverse()
    return list
        
def mod_exp_loop(a,d,n):
    list = int_to_list(d)
    res = 1
    for i in list:
        if i == 1:
            res = (res*res*a)%n
        if i == 0:
            res = (res*res)%n
    return res
    

def encrypt(plaintext, public_e, public_n):
    return mod_exp_loop(plaintext,public_e,public_n)
    
def decrypt(ciphertext, private_d, public_n):
    return mod_exp_loop(ciphertext,private_d,public_n)


p = 11260863207212702103460474093002595541449751697925862895654841505993756717287186060653826108669131114554096873072576118014083178999905221008214722001943339
q = 10057860828989564052637278955977000644334785958542967421198451589491463097151456183670351992389841894659540570390117889232610166686311055148114238796103417
d = 8305074725190761972366331243652021211924169608785074495141050762295611838271273724404145023187862955672708746673974633897343487958612111374810279454858718910243580623281005819150624252059266461904978411154443377668435436188273706085183276492525480513739866133934692841053817657950345126681354159242799474347

n = 113260194952434428981951733893781234432419868320111419066814922955469956269960201679251909243818953090639888714544434398138116870539460244823557720190230142576463299304733645756171752038652812958369618155373948736593796295616970859508229204400075985688377216796670156758709736970223449792242430612854818289363
e = 96795211118947281194260986456594784658390834518388469846420068005664550706889369645122147878894508011686461149937593954424113836380132618323633614387490623590526395757331540596114940788465444103587318299673224568858970007198004077501027862265892579807114250435344878839198755080917086890797621580106304054227


    

print n==(p*q)
print (d*e)%((p-1)*(q-1))==1

plaintext = 2013011404
ciphertext = encrypt(plaintext, e, n)
print ciphertext
print decrypt(ciphertext, d, n)



